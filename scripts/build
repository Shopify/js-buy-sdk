#!/usr/bin/env node

/* globals require process */

require('./util/work-from-root')();

var fsExtra = require('fs-extra');
var buildProject = require('./util/build-project');
var docBuilder = require('./util/build-doc')({ docsBranchName: 'gh-pages-6', commitDocs: true, rmSrcDir: true });

var buildPath = 'dist';

fsExtra.removeSync(buildPath);

process.env.BROCCOLI_ENV = 'production';

console.log('Building ....');
buildProject(buildPath, function (buildStatus) {
  if (buildStatus !== 0) {
    return process.exit(buildStatus);
  }

  docBuilder.build(function () {
    console.log('\nDone building');
  })

});
